# Android异常分析之安全模式

## 启动崩溃安全模式流程

> 针对不同的异常类型可以设置不同的标志位加以区分。此处统计启动崩溃这种异常场景。

* 应用启动时设定标志位。
* 监控应用的异常退出，发生时更新标志位。
* 检测到应用多次异常退出时，进入安全模式。
* 执行清除数据等操作进行修复并清除标志位。
* 用户正常使用时，清除标志位。

![android安全模式](./Android%E5%BC%82%E5%B8%B8%E5%88%86%E6%9E%90%E4%B9%8B%E5%AE%89%E5%85%A8%E6%A8%A1%E5%BC%8F.assets/android%E5%AE%89%E5%85%A8%E6%A8%A1%E5%BC%8F.png)

## 异常退出的场景

* **主动自杀**。Process.killProcess()、exit() 等。
* **崩溃**。出现了 Java 或 Native 崩溃。
* **系统重启**。系统出现异常、断电、用户主动重启等，我们可以通过比较应用开机运行时间是否比之前记录的值更小。
* **被系统杀死**。被 low memory killer 杀掉、从系统的任务管理器中划掉等。
* **ANR**。

